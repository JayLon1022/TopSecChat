联网打印机安全风险分析及调查报告

1 天融信阿尔法实验室

目录
一、联网打印机安全态势
1.1 联网打印机全国分布态势
1.2 联网打印机关键基础设施行业分布态势
1.3 国内联网打印机应用层协议统计
1.4 国内联网打印机品牌统计
1.5 联网打印机漏洞数量历史统计
1.6 国内联网打印机漏洞数量厂商排名
二、联网打印机技术
2.1 联网打印机特点
2.2 设备控制协议
2.3 网络打印协议
2.4 打印控制语言
2.5 页面描述语言
三、攻击者模型和漏洞类型
3.1 DoS攻击
3.1.1 占用传输通道
3.1.2 占用文件处理
3.1.3 物理损坏
3.2 权限提升
3.2.1 恢复出厂设置
3.2.2 Accounting绕过
3.3 信息泄露
3.3.1 内存访问
3.3.2 文件系统访问
3.3.3 凭证泄露
3.4 RCE漏洞
3.4.1 缓冲区溢出
3.4.2 固件更新
3.4.3 定制软件包
四、网络打印机漏洞案例
4.1 DoS攻击漏洞案例
4.1.1 Brother联网打印机DoS攻击漏洞
4.2 权限提升漏洞案例
4.2.1 HP企业打印机权限提升漏洞
4.3 信息泄露漏洞案例
4.3.1 HP LaserJet打印机信息泄露漏洞
4.4 RCE漏洞案例
4.4.1 HP Ink Printers远程代码执行漏洞
4.4.2 HP PageWide和HP OfficeJet Pro打印机任意代码执行漏洞
五、联网打印机安全风险防范措施
5.1 对厂商的风险防范建议
5.1.1 制定开放、充分研究的标准
5.1.2 数字签名采用单一对策
5.1.3 采用生物识别技术
5.1.4 采用数字水印技术
5.2 对管理员的风险防范建议
5.2.1 设置安全的用户名和密码
5.2.2 关闭不必要的协议
5.2.3 断开打印机外网连接
5.2.4 采用白名单机制
5.2.5 对打印机定期安全测试
5.3 对普通用户的风险防范建议
5.3.1 提高安全意识
5.3.2 参加安全培训
5.3.3 注意安全使用事项

一、联网打印机安全态势
打印机是连接计算机的常见外设之一，是人们生活和办公中经常使用的设备。随着信息技术的快速发展，资源共享不仅限于信息，还包括相关附属设备的共享。打印机因其低成本、可共享、方便快捷的特点，广泛应用于企业、政府、医院、学校等重要行业，成为工作、生产、经营中的必需品，其产量约占计算机外设的20%。根据IDC统计，2019年中国打印设备市场出货量约6480万台。随着技术的革新，绝大部分在售打印设备均支持联网打印功能，打印机的联网化、在线化趋势明显。从安全角度来看，打印设备部署在内部网络中，通过它们可以直接访问机密报告、合同或病历等各种敏感信息。联网打印机的软硬件漏洞可能导致设备数据和用户信息泄露、设备瘫痪、被用作跳板攻击内网主机和其他信息基础设施等安全风险。许多企业由于联网打印机系统存在的安全脆弱问题，导致其成为网络安全防护的重大隐患。天融信阿尔法实验室根据天融信云服务威胁感知平台和CNVD获取的联网打印机相关数据，从联网打印机全国分布、关键基础设施行业分布、应用层协议、品牌、漏洞数量历史统计、厂商排名等角度对联网打印机安全态势进行了分析。

1.1 联网打印机全国分布态势
根据天融信云服务威胁感知平台的数据，国内联网打印机数量约为44000台，排名前五的省份或地区为：台湾省（31612台）、香港特别行政区（6518台）、广东省（937台）、北京市（890台）和江苏省（540台）。

1.2 联网打印机关键基础设施行业分布态势
我国境内的联网打印机设备分布在多个行业，其中关键基础设施行业联网打印机共1773台，教育行业946台，占比54.4%；电信与互联网行业503台，占比28.4%；国内政府机关150台，占比8.5%。

1.3 国内联网打印机应用层协议统计
根据国内联网打印机数据分析，我国联网打印机主要应用的协议有：HTTP、FTP、HTTPS、TELNET、PJL、UPNP和LPD。

1.4 国内联网打印机品牌统计
根据国内联网打印机数据分析，我国联网打印机的品牌分布以惠普、爱普生、柯尼卡美能达、理光、兄弟等品牌为主。

1.5 联网打印机漏洞数量历史统计
根据CNVD每年公布的联网打印机漏洞数量进行统计，近几年联网打印机漏洞数量持续增长。

1.6 国内联网打印机漏洞数量厂商排名
根据统计，2019年CNVD收录的打印机漏洞共22个，涉及的厂商包括HP、Epson、Ricoh等，其中HP打印机设备漏洞最多，共7个。

二、联网打印机技术
2.1 联网打印机特点
联网打印机需要扩展网络端口进行通信，使用不同类型的操作系统，并具备一些共同特点，如精简指令集、较老内核以及保留一些“隐藏”功能。

2.2 设备控制协议
大多数打印机使用SNMP协议进行管理，SNMP是一种基于UDP协议的应用层协议，主要包括管理信息库MIB和SNMP报文协议。

2.3 网络打印协议
被广泛使用的网络打印机打印协议包括LPD、IPP、SMB和TCP 9100原始端口。每种协议都有其特点。

2.4 打印控制语言
不同厂商有各自特定的打印控制语言，其中PJL是被大多数打印机厂商兼容的语言。

2.5 页面描述语言
页面描述语言用于定义文档的实际外观，主流厂商实现了自己的页面描述语言。

三、攻击者模型和漏洞类型
攻击者的攻击途径主要分为本地攻击、网络攻击和WEB攻击。

3.1 DoS攻击
针对打印机的DoS攻击可以通过占用传输通道、占用文件处理和物理损坏等方式实现。

3.2 权限提升
可以通过恢复出厂设置和Accounting绕过等方式实现权限提升。

3.3 信息泄露
信息泄露主要分为内存访问、文件系统访问和凭证泄露。

3.4 RCE漏洞
远程代码执行的方法有缓冲区溢出、固件更新和定制软件包等。

四、网络打印机漏洞案例
4.1 DoS攻击漏洞案例
Brother联网打印机存在DoS攻击漏洞，攻击者可以通过发送畸形HTTP请求导致打印机拒绝服务。

4.2 权限提升漏洞案例
HP企业打印机存在权限提升漏洞，攻击者可以通过特定命令恢复出厂设置，重设管理员密码。

4.3 信息泄露漏洞案例
HP LaserJet打印机存在信息泄露漏洞，攻击者可以通过PJL接口访问打印机内部文件系统。

4.4 RCE漏洞案例
HP Ink Printers存在远程代码执行漏洞，攻击者可以通过发送恶意构造的文件获取打印机控制权。

五、联网打印机安全风险防范措施
5.1 对厂商的风险防范建议
应制定开放、充分研究的标准，采用数字签名、应用生物识别技术和数字水印技术等措施提升安全性。

5.2 对管理员的风险防范建议
应设置安全的用户名和密码，关闭不必要的协议，断开打印机外网连接，采用白名单机制，并定期进行安全测试。

5.3 对普通用户的风险防范建议
提高普通用户的安全意识，参加安全培训，注意可疑人员的使用行为，并及时报告可疑的打印输出。