朝鲜Lazarus组织样本分析

目录
一、 概述
二、 程序逆向
三、 附录

一、 概述
在5月6日，从互联网获取了一份病毒样本，该样本是一个带宏的文档，旨在诱骗目标点击启用宏。通过读取内容，利用zlib的压缩机制躲避静态检测，整个过程调用加密算法，解密出第一段病毒代码，并从中解压出第二段病毒代码。第二段病毒代码使用自定义解密算法，解密出黑客的后台地址并进行连接。

二、 程序逆向
检测文档确认其中含有宏代码。宏代码位于第八段，诱导受害者点击启用宏。通过绕过密码获取宏代码，文件会在临时目录下建立一个名为image003.png的文件，并生成并运行image003.zip。

发现有JavaScript脚本，文件将在公用目录下释放AppStore.exe。

使用侦壳软件检测，判断该程序为无壳状态，并释放第一段shellcode。从第一段shellcode中解密出第二段shellcode。

提取第二段shellcode，并用侦壳软件检查提取后的程序，确认没有壳。利用自定义的解密算法，解密出黑客连接的地址。

构造浏览器请求头，访问失败并返回调用信息。

三、 附录
文中涉及样本SHA256：
f1eed93e555a0a33c7fef74084a6f8d06a92079e9f57114f523353d877226d72