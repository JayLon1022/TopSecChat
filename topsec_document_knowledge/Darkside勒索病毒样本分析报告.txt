Darkside勒索病毒样本分析

目录
一、概述
二、程序逆向
三、附录

一、概述
6月10日，从互联网中获取了病毒样本。该样本启动后，主要通过调用外部程序、清理证书、添加计划任务以及访问黑客后台下载挖矿程序和病毒本体。

二、程序逆向
使用侦壳软件检测，发现该样本无壳。如下图所示：

动态解密配置文件，检测是否被调试。
加载ntdll模块，使用netCreateUserProcess函数调用外部程序。
解密外部程序的具体参数。
调用certutil.exe删除所有证书。
使用cmd程序调用tasklist。

访问黑客后台，下载挖矿程序。
调用计划任务，提升权限并定时从黑客服务器下载木马程序，下载至temp文件夹。
调用挖矿程序，设置矿池和钱包。

附录
文中涉及的样本SHA256：
484cf2f2060cc47d7a5a3d27d85b17214153f4d9e2235cc9770609387547baab