天融信听风者实验室 ｜ 蔓灵花（BITTER）近期攻击活动分析

概述
蔓灵花组织（BITTER）的攻击活动最早可以追溯到2013年，自2018年以来，攻击活动愈发频繁并持续至今。该组织长期针对中国和巴基斯坦展开攻击，涉及的行业包括政府、外交、国防、军工、核能等。攻击的主要目的是窃取敏感信息，具有明显的政治背景。近期，天融信听风者实验室APT研究团队捕获到BITTER组织的攻击活动，向用户投递可能感兴趣的诱饵文档，受害者在打开文档后下载木马模块执行，从而实现长期控制并窃取机密文件。

攻击活动分析
听风者实验室APT研究团队监控到BITTER组织的攻击活动线索，经过对相关样本的跟进分析，发现了该组织的攻击活动。以下是本次攻击活动中捕获到的部分插件，攻击组织使用了新的.NET文件上传插件。

文件上传插件分析
该插件为32位.NET类型可执行文件。插件开始执行时会解密多个字符串，包括用于的文件名，以及上传文件的URL路径http://23.83.133.128/xxx/sthost.php。

插件执行后，首先会判断当前路径下是否存在History.txt文件。如果不存在，说明是首次执行，将发送一次主机名和Mac ID。

插件会解密多个字符串，用于作为文件路径遍历的筛选条件，包括文件路径黑名单、感兴趣的文件后缀名以及重点关注的文件夹。

随后，插件将进行全盘文件遍历，记录所有文件路径，并标记文件修改日期及具体时间，将感兴趣的文件路径记录到Systemfile.txt中。每次上传文件时，都会先发送文件信息。

随后发送文件内容，接收服务器返回数据，判断是否发送成功，将发送成功的文件路径写入Historyfile.txt。

执行完成后，插件将进入短暂休眠，然后重复执行文件上传任务。BITTER组织是一个持续活跃的APT组织，长期针对国内开展攻击活动。天融信听风者实验室将继续密切跟踪APT组织的活动，不断研究其使用的新型攻击手法，为客户提供应对高等级安全威胁的检测及响应能力，帮助客户有效抵御面临的网络威胁。