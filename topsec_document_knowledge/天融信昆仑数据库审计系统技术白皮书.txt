天融信昆仑系列数据库审计系统技术白皮书

版权声明  
本文档中的所有内容及格式的版权属于北京天融信公司（以下简称天融信）所有，未经天融信许可，任何人不得仿制、拷贝、转译或任意引用。  
版权所有，不得翻印 © 2024 天融信公司  

商标声明  
本文档中所谈及的产品名称仅作识别之用。文档中涉及的其他公司的注册商标或版权属各商标注册人所有，恕不逐一列明。  

信息反馈  
http://www.topsec.com.cn  

变更记录  
版本    修订日期    修订人    修订类型    修订章节    修订内容  
V23.1.0  2023/5/5   莫雪骄   A           ALL          ALL  
V23.1.1  2024/2/22  龚启光   A           ALL          ALL  

注：对该文件内容的增加、删除或修改均需填写此记录，详细记载变更信息，以保证其可追溯性。  

目录  
1 产品概述  
1.1 背景介绍  
1.2 系统架构  
2 产品特点  
2.1 数据库类型审得全  
2.2 数据库资产可视化  
2.3 即查即统高效查询  
2.4 审计要素精准详实  
2.5 满足用户合规需求  
3 产品功能  
3.1 全面数据库审计  
3.2 清晰的资产监控  
3.3 细粒度操作还原  
3.4 精准的业务关联  
3.5 智能的行为基线  
3.6 数据库性能分析  
3.7 数据库威胁检测  
3.8 精细的业务报表  
3.9 云环境审计支持  
3.10 全场景协同联动  
3.11 可靠的系统管理  
3.12 灵活的双协议栈  
3.13 高效的数据脱敏  
4 部署模式  
4.1 旁路部署  
4.2 级联部署  
4.3 分布式部署  
5 产品规格  
6 产品资质  

天融信昆仑系列数据库审计系统技术白皮书  
1 产品概述  
1.1 背景介绍  
随着IT技术的飞速发展，数据库已经成为信息技术的重要组成部分，是现代计算机信息系统和计算机应用系统的基础与核心。数据库作为商业公司中最有价值的重要资产，通常保存着重要的数据信息，这些信息资产面临的挑战日益严峻。据《2018数据泄露损失研究》评估显示，大型数据泄露代价高昂，百万条记录可能导致损失4000万美元，5000万条记录可能导致损失3.5亿美元。遭遇数据泄露事件的公司企业平均要损失386万美元，同比去年增加了6.4%。数据库泄漏防不胜防，主要是部分企业单位安全意识薄弱，未采取相应的技术手段，仍在采用数据库本身的日志文件实现审计，该方式的缺点是：影响数据库本身性能、数据库日志文件易篡改、操作日志查看不直观。

另外，GB/T22239-2019《信息安全技术网络安全等级保护基本要求》也对安全审计提出了明确要求，在国家法律法规层面确定了安全审计的重要性，还强调IT系统内部控制的《萨班斯法案》与《银行业金融机构信息系统风险管理指引》等。

针对以上需求场景，传统的安全设备难以胜任，急需专业的数据库审计系统记录用户对数据库的操作行为。天融信数据库审计系统（以下简称“TA-DB”）是一款针对上述环境推出的专业数据库审计产品，提供数据库实时监控、风险预警、威胁阻断等功能，充分满足政府、金融、公安、能源、运营商、教育、军工、交通、企业等各行业的数据库审计需求。

1.2 系统架构  
天融信昆仑系列数据库审计系统（TA-DB）基于飞腾CPU和麒麟操作系统，采用全模块化设计和中间层理念，形成先进的多核架构技术体系，确保在国产硬件平台上TA-DB产品具有高速的数据审计解析能力，能够胜任复杂网络环境下的安全审计要求。

2 产品特点  
2.1 数据库类型审得全  
TA-DB产品利用协议解析技术准确识别数据库类型，能够精准识别并审计主流数据库、关系型数据库、国产化数据库、NoSQL等40多种数据库协议类型，支持数据库协议类型业界领先。包括但不限于：Oracle系列、SQL Server系列、GreenPlum系列、mongoDB系列、MYSQL系列、PostgreSQL系列、Cache系列、达梦系列、TDSQL系列、GoldenDB系列、GaussDB系列、人大金仓系列、南大通用系列。

2.2 数据库资产可视化  
TA-DB将审计到的SQL语句与资产实例结合，内置数据轨迹模型，以资产为核心，以数据流转为轨迹，图形化展示操作行为，让数据轨迹清晰可见。TA-DB根据审计到的SQL数据，实时发现活跃实例，发现未知的、潜在危害的实例，实时感知资产健康状况，并可根据安全模型对其进行安全风险评估。数据轨迹模型有效解决实例难发现、资产难管控、风险难评估的问题，实现了数据轨迹清晰可见。

2.3 即查即统高效查询  
TA-DB基于自研高效检索算法，优化底层数据结构，并结合前端页面异步加载技术，实现多维度自定义查询，即查即统，查询结果在前端页面快速呈现，实现千万级数据秒级回显。

2.4 审计要素精准详实  
TA-DB可对网络流量进行高速、精准解析和还原，不仅可以实时审计各种数据库操作（DDL、DML、DCL等），还可以审计和还原数据库返回结果，返回的结果涵盖源目的IP、数据库用户名、SQL语句、SQL返回结果集等字段内容。TA-DB将数据库的所有访问情况实时可视化展示，管理者可快速回溯定责各种数据库安全事件，有效加强内部审计监督能力。

2.5 满足用户合规需求  
通过使用TA-DB可有效帮助网络运营者满足安全审计的相关要求，全面提升网络运营者的网络安全防护能力，保障网络的稳定运行。

3 产品功能  
天融信数据库TA-DB主要的功能模块包括清晰的资产监控、细粒度的操作还原、精准的业务审计等12个部分。

3.1 全面数据库审计  
TA-DB通过数据库协议自动识别技术，结合灵活的审计策略，对国际、国内、NoSQL等40多种数据库进行全面审计，包括但不限于Oracle系列、SQL Server系列、GreenPlum系列、mongoDB系列、MYSQL系列、PostgreSQL系列、Cache系列、达梦系列、TDSQL系列、GoldenDB系列、GaussDB系列、人大金仓系列、南大通用系列。

3.2 清晰的资产监控  
TA-DB内置的数据轨迹模型，以资产为核心，以数据流转为轨迹，图形化展示操作行为，让数据轨迹清晰可见。通过实例发现，让隐藏在网络环境中的已知数据库实例、未知数据库实例、潜在风险数据库实例清晰可见。将核心实例所属资产加入监控，除了监控资产的基本信息外，还能深入实时监控资产负载、活跃会话、总会话、连接池、表空间、缓冲区、事务数、游标、用户数、进程死锁等信息。同时，TA-DB支持基于实例的审计事件、告警事件等进行趋势分析，综合评估资产的健康状况，保证资产的可用性和响应能力。

3.3 细粒度操作还原  
TA-DB通过对双向数据报文的识别与解析，不仅解析出基本的五元组信息和基本的数据库协议要素，还可根据业务要求进行更细粒度的SQL解析。支持全类型的绑定变量解析和全类型的结果集解析，并提供数据库原厂商问题解决方案。还支持超长SQL语句解析，保证SQL语句零遗漏的审计；友好的界面可实现审计结果详情完整展示、SQL会话倍速回放等。

3.4 精准的业务关联  
通过对浏览器与Web服务器、Web服务器与数据库服务器之间所产生的HTTP事件和SQL事件进行业务关联分析，管理者可以快速、方便地查询某个数据库访问是由哪个HTTP访问触发，从而将访问Web的资源账号与相关的数据库操作关联起来，100%精准展示终端用户对数据库的操作行为。

3.5 智能的行为基线  
TA-DB内置强大的智能学习算法，可以基于一定业务周期内的审计数据进行学习，生成行为基线，基于此行为基线对后续的SQL事件进行检测，对于偏离基线的行为产生异常告警。

3.6 数据库性能分析  
TA-DB内置性能分析引擎，可以对SQL执行效率进行分析，发现内部数据库的性能薄弱点，动态呈现内部资产存在的异常情况，帮助用户及时发现内网数据库性能隐患。同时，系统能够多维度展示用户SQL操作错误的占比及趋势，从源IP维度以柱状图展示SQL错误数，以列表形式提供出错原因、出错信息及解决办法。

3.7 数据库威胁检测  
TA-DB内置强大的攻击检测引擎，可以高效实现漏洞检测、僵尸主机检测，并对SQL注入、XSS跨站攻击、缓冲区溢出、拒绝服务攻击等危险行为实时告警。除内置的权限管控策略外，TA-DB还可针对登录用户、SQL语句、操作类型、操作对象等数据库协议要素配置全方位的告警策略，判断事件的危险级别，进行实时响应处理。

3.8 精细的业务报表  
TA-DB提供丰富灵活的报表统计模板，包括合规性报表模板。内置多种业务统计场景，如SQL操作类型、SQL响应时间、影响行数等，全方位满足审计项要求。系统内置报表任务，可周期性生成日报、周报和月报，并支持多种格式的报表文件导出，能够通过邮件发送至相关人员，同时支持根据业务要求定制符合需求的业务报表。

3.9 云环境审计支持  
为应对复杂的云环境，TA-DB除了支持在云数据库上安装Agent引流进行审计外，还支持反向代理功能，通过内置的反向代理策略获取客户端对云端数据库进行操作的流量，从而解析对数据库的操作。

3.10 全场景协同联动  
针对审计事件和告警事件，TA-DB提供全场景的安全响应机制。系统提供8个级别的告警设置，支持通过多种方式外发响应事件，能够与第三方管理平台进行联动，支持阻断违规事件。

3.11 可靠的系统管理  
TA-DB提供版本回滚、抓包工具、一键巡检等功能，登录过程可采用多种国密算法进行验证，最大程度保证设备的安全可靠运行。

3.12 灵活的双协议栈  
系统全面支持IPv6协议族，能够在IPv6网络环境中实现TA-DB的所有功能，并通过了业界权威的IPv6 Ready LogoⅡ认证。

3.13 高效的数据脱敏  
系统内置高效的脱敏算法，对数据进行遮盖、变形、漂白，将敏感数据去标识化处理，为企业在系统开发、测试、培训和大数据应用等情况下的数据安全使用提供保障。

4 部署模式  
4.1 旁路部署  
旁路部署是最常见的部署方式，将审计系统接到交换机的镜像口后即可使用，系统上线方便快捷，不影响原有网络结构。

4.2 级联部署  
级联部署中每台审计系统都是独立运行的设备，审计自身的网络数据。上级设备可下发策略，查看下级设备的统计分析结果，适应客户网络结构，解决客户分级控制和审计的需求。

4.3 分布式部署  
分布式部署中，利用多台TA-DB设备分担用户整个网络数据库审计负荷，并采用高性能的集中管理中心，有效解决监控点分散、性能压力大的问题。管理中心负责策略下发、数据查询等，用户可根据自身情况决定审计事件的存储方式。

5 产品规格  
TA-DB为软硬一体件产品，同时提供命令行与B/S架构的系统管理平台供用户全方位配置与管理。  
型号：天融信数据库审计系统V3  
CPU：飞腾D2000 (2.3GHZ, 8核)  
操作系统：银河麒麟V10 (内核版本4.19.90)  
内存：32GB  
硬盘：24TB、18TB、8TB、4TB，支持存储空间扩展  
网络接口：2个千兆管理口、4个业务口、4个千兆光业务口、2个10Gb万兆光业务口  
USB接口：2个  
产品形态：2U标准机架式设备  
冗余电源：标配模块化双电源  
净重：11.3Kg  
毛重：15.4Kg  
电压：AC100~240V  
频率：50~60HZ  
电流：5A-3A  
功率：550W  
运行温度：0℃~40℃  
存储温度：-40℃~55℃  
相对湿度：10%~90%RH非凝结  

6 产品资质  
证书名称：计算机信息系统安全专用产品销售许可证（增强级）  
认证机构：公安部网络安全保卫局  
证书名称：涉密信息系统产品检测证书  
认证机构：国家保密科技测评中心  
证书名称：计算机软件著作权登记证书  
认证机构：中华人民共和国国家版权局  
证书名称：中标麒麟软件NeoCertify认证（兆芯版）  
认证机构：麒麟软件有限公司  
证书名称：银河麒麟软件NeoCertify认证（飞腾版）  
认证机构：麒麟软件有限公司  
证书名称：飞腾CPU兼容性证明  
认证机构：天津飞腾信息技术有限公司  
证书名称：海光CPU兼容性证明  
认证机构：海光信息技术股份有限公司  

声明  
1. 本文档所提到的产品规格及资讯仅供参考，内容可能随时更新，天融信不另行通知。  
2. 本文档中提到的产品功能或性能可能因具体型号、配备环境、配置方法不同而有所差异，此种情况产生的差异为正常现象，产品功能或性能请以产品用户手册等资料为准。  
3. 本文档中提到的信息为正常公开的信息，若因本文档或其提到的任何信息造成或可能造成他人直接或间接的资料流失、利益损失，天融信及其员工不承担任何责任。