天融信昆仑系列日志收集与分析系统技术白皮书

北京市海淀区西北旺东路10号院西区11号楼东侧 天融信科技集团 100193
电话：010-82776666
传真：010-82776677
服务热线：4007770777
http://www.topsec.com.cn

版权声明
本文档中的所有内容及格式的版权属于北京天融信公司（以下简称天融信）所有，未经天融信许可，任何人不得仿制、拷贝、翻译或任意引用。
版权所有 不得翻印 © 2024 天融信公司

商标声明
本文档中所提及的产品名称仅用于识别，文档中涉及的其他公司的注册商标或版权归各商标注册人所有，恕不逐一列明。

信息反馈
http://www.topsec.com.cn

变更记录
版本 修订日期 修订人 修订类型 修订章节 修订内容
V23.1.0 2023/5/16 陈俊 M 1. 修改文档格式

注：对该文件内容的增加、删除或修改均需填写此记录，详细记载变更信息，以保证其可追溯性。

目录
1 前言
1.1 背景
1.2 日志审计需求
2 总体架构
2.1 系统总体架构
2.2 产品规格组成
3 产品主要功能
3.1 综合展示
3.2 海量日志高效采集与处理
3.2.1 设备类型及日志类型支持广泛
3.2.2 多协议采集
3.2.3 分布式采集模式
3.2.4 原始数据高效处理
3.3 交互式全文检索
3.4 统计分析
3.4.1 内置丰富统计分析主题
3.4.2 自定义统计分析主题
3.4.3 统计分析任务
3.4.4 合规分析
3.5 关联分析
3.5.1 内置关联分析规则库
3.5.2 图形化关联分析场景编辑
3.6 告警分析
3.7 日志可视化分析
3.8 系统管理
3.8.1 数据存储策略
3.8.2 日志转发
3.8.3 用户管理
3.8.4 多级管理
4 产品应用部署
4.1 多级部署
4.2 单机部署
5 产品规格

前言
1.1 背景
随着网络安全意识的增强和网络安全建设工作的推进，以及《中华人民共和国网络安全法》、等级保护、分级保护等各行业的信息安全管理标准的实施，各企事业单位迫切需要建设并落实自己的IT设备与系统的日志审计平台，以应对日益严峻的合规审计要求和业务连续性需求。

各类网络设备、安全设备（如防火墙、入侵检测系统、防病毒软件等）、操作系统（如Windows、Unix等）、应用服务（如电子邮件、WWW、DNS等）自身都记录了大量的日志数据。这些日志数据详实地记录了系统和网络的运行状态及各类信息，既是记录、检测、分析、识别各类安全事件和威胁的重要信息来源，也是评估当前网络安全现状的重要依据。然而，这些数据分散存储在各种设备中，相互独立，形成信息孤岛，无法进行有效的关联分析和事件挖掘。因此，需要建设一个能够集中收集、存储、查询各类日志信息的安全审计管理中心，对日志信息进行统一、全面、有效的综合分析，为管理员提供一个方便、高效、直观的审计平台，提高安全管理员的工作效率和质量，更加有效地保障信息系统的安全运行。

1.2 日志审计需求
国家主管部门为了加强网络安全建设，陆续出台了《中华人民共和国网络安全法》、等级保护、分级保护等法律法规。网络安全法第二十一、第五十九条明确规定了网络日志必须保留至少六个月，违法者将受到处罚。GB/T 22239-2018《信息安全技术信息系统安全等级保护基本要求》要求二级及以上系统需要进行安全审计，审计范围应覆盖到服务器上的每个操作系统用户和数据库用户，审计内容应包括重要用户行为、系统资源的异常使用和重要系统命令的使用等系统内的重要安全相关事件。审计记录应包括事件的日期、时间、类型、主体标识、客体标识和结果等，并应保护审计记录，避免未预期的删除、修改或覆盖等情况。《互联网安全保护技术措施规定》（公安部82号令）第八条要求具备“记录、跟踪网络运行状态，监测、记录用户各种信息、网络安全事件等安全审计功能”。

同时，海关、税务、石油石化、金融、电力等国家机关或行业也陆续出台了相关的内部信息安全控制指引或行业信息安全管理规范，均要求日志审计成为满足合规及内部控制要求的必要功能。例如，《商业银行内部控制指引》第一百二十六条指出“商业银行的网络设备、操作系统、数据库系统、应用程序等均应设置必要的日志，日志应能够满足各类内部和外部审计的需要”。《银行业信息科技风险管理指引》第二十七条要求银行业制定相关策略和流程，管理所有生产系统的日志，以支持有效的审核、安全取证分析和预防欺诈。《保险公司信息系统安全管理指引（试行）》第四十四条要求“对主机系统进行审计，妥善管理并及时分析处理审计记录。对重要用户行为、异常操作和重要系统命令的使用等应进行重点审计”。

此外，随着组织与企业信息化程度的提高，各类网络设备、安全设备（如防火墙、入侵检测系统、防病毒软件等）、操作系统（如Windows、Unix等）、应用服务（如电子邮件、WWW、DNS等）产生的海量日志数据已经无法依靠人工进行收集与分析。随着日志数据量成倍增长，日志量已经从原来的几千事件每秒上升到数万事件每秒。传统的基于关系型数据库的日志审计系统面对海量日志数据已经无法进行有效的处理。因此，运维管理人员需要一套具备高效集中海量存储、先进的搜索引擎、深度挖掘分析、关联技术、动态实时可视化展示、灵活丰富报表和多样化告警方式等能力的新一代日志审计系统。

天融信公司经过20余年帮助用户进行信息安全管理建设的经验发现，一些单位由于网络规模相对小、业务应用相对简单以及信息安全管理人员技术能力相对薄弱等实际情况，管理员强烈期望能有一款功能简洁、部署方便、使用简单、价格适宜且无需过多运维的安全管理平台。同时，这个平台能够满足相关法律法规及行业标准的合规性检查，切实为用户对其IT信息系统进行日常管理提供必要的技术手段。

因此，天融信根据在信息安全领域取得的研究成果与技术积累，推出了一款针对海量日志管理、满足合规性要求的新一代昆仑系列日志管理系统，全面应对大数据时代用户在日志审计合规性和实际信息安全管理方面的需求。

总体架构
2.1 系统总体架构
天融信昆仑系列日志收集与分析系统是基于国产处理器和国产操作系统研发的新一代海量日志管理系统。系统采用国产CPU芯片（如飞腾、海光）和国产操作系统（银河麒麟），通过主被动结合的技术手段，24小时不间断采集网络中安全设备、网络设备、服务器资源和应用系统的日志。通过对日志的采集、处理、存储、备份、查询统计、合规报表及关联分析，实现海量日志的全生命周期管理。系统主要包含：日志采集子系统、日志分析子系统、数据存储子系统、综合展示子系统和系统管理子系统。

审计对象主要包括不同厂商、各种类型的安全设备、网络设备、数据库、中间件和应用服务等设备与信息系统。系统将对这些纳入管理范围的设备与信息系统产生的海量日志数据进行全生命周期管理。

日志采集子系统利用数据采集引擎和数据处理引擎，采用被动与主动采集技术相结合，通过Syslog、SNMP Trap、NetFlow、Telnet/SSH、WMI、FTP/SFTP/SCP、JDBC、文件等标准协议从审计对象获取海量日志数据。该子系统采用异步I/O、数据零拷贝和高速缓存等技术，实现了海量数据的高效采集，确保零丢包。系统对采集的海量原始日志数据进行归一化、过滤、建立数据索引并进行压缩加密存储，所有数据统一存储在数据存储子系统中。

数据存储子系统主要包括关系型数据库、本地存储和网络存储。系统采用关系型数据库存储系统配置信息、统计结果等数据，对预处理后的格式化日志数据和原始数据进行分片存储，确保高性能、高伸缩性和高可用性，极大降低数据读写冲突。同时，采用文件分段压缩技术，提高数据写入速度和磁盘利用率。系统支持多策略存储管理，根据不同类型的设备设置不同的存储保存时间、存储空间上限等，超过存储上限时自动删除旧日志。

日志分析子系统利用查询分析引擎和统计分析引擎从数据存储子系统获取相关数据，进行实时合规分析、快速检索等，并将分析结果发送给综合展示子系统。

系统管理子系统主要提供对系统的日常管理，包括权限管理和日志转发管理等功能，相关功能依托综合展示子系统提供的人机交互界面进行。

综合展示子系统主要面向用户提供图形化人机交互界面，用户可通过界面对系统进行日常管理，查看各类统计分析结果、数据检索结果及告警信息等。

2.2 产品规格组成
产品由审计中心和分布式采集代理两部分组成。分布式采集代理负责实现对海量日志数据的统一采集，同时进行数据的归一化、分类、过滤等处理，并上传给审计中心进行集中存储。

审计中心分为上级审计中心和下级审计中心，均包含系统的核心功能组件，各级审计中心完全自制，具备同等的数据处理性能。通过Web方式提供管理，用户只需通过浏览器登录审计中心管理界面即可进行相关功能操作。下级审计中心可根据业务范围、网络拓扑和性能负载动态扩展部署。下级审计中心不需要向上级审计中心传送日志，上级审计中心可直接远程查询和统计各个下级审计中心的日志。

审计中心内置日志采集功能，具备收集本级所有审计对象日志数据的能力，同时可以汇聚各分布式采集节点上传的海量日志数据。

分布式采集节点需安装在独立服务器上，实现对数据的高效采集与处理。采集器可以进行数据的采集并同时进行归一化、分类等数据处理，收集的日志可以转发给审计中心。

产品主要功能
3.1 综合展示
系统提供主页综合展示功能。通过主页面实时动态了解当前系统部署逻辑拓扑结构、日志源类型分布情况、日志数量分布情况，以及安全事件告警、安全运行情况等。图形化展示界面直观、形象，支持鼠标悬停展示详细信息，点击快速跳转。此外，主页面可查看本系统的综合运行情况等系统信息。

3.2 海量日志高效采集与处理
3.2.1 设备类型及日志类型支持广泛
系统目前已支持26类300多种设备的信息采集，涵盖国内外主流厂商，具体包括但不限于防火墙、入侵检测、VPN、数据库等多种设备。

3.2.2 多协议采集
系统利用数据采集引擎、数据处理引擎，采用被动与主动采集技术相结合，通过多种标准协议从审计对象获取海量日志数据。

3.2.3 分布式采集模式
系统支持分布式采集节点的安装，能够实现高效的数据采集与处理，采集器可根据实际需要设计开启不同的功能。

3.2.4 原始数据高效处理
系统对采集到的海量日志数据进行归一化、过滤、分类等处理，并将原始数据及处理后的数据进行压缩加密存储。

3.3 交互式全文检索
系统采用自主研发的快速搜索引擎，实现对任意字符串集合的数据检索，可以实现百亿级数据的快速检索，查询结果支持导出。

3.4 统计分析
系统提供丰富的统计分析主题，支持自定义统计分析模板，能够生成各种形式的报表，并支持计划报表管理和合规性分析。

3.5 关联分析
系统内置关联分析规则库，支持用户自定义关联规则，能够实时监测、分析、查询、调查和追溯安全事件。

3.6 告警分析
系统提供安全告警摘要和多维度图形化展示，帮助管理员直观掌握网络环境安全现状，并支持多种告警方式。

3.7 日志可视化分析
支持日志查询结果进行图形化展示，帮助用户直观分析数据。

3.8 系统管理
系统支持自定义存储策略、日志转发和基于角色的用户管理，具备多级管理的能力。

产品应用部署
4.1 多级部署
适用于大型组织的多级审计中心部署模式。

4.2 单机部署
适用于小型网络环境的单机部署模式，只需在一台服务器上部署审计中心系统。

产品规格
型号：天融信日志收集与分析系统V3
产品形态：硬件，2U标准机架式设备
CPU：飞腾处理器
操作系统：银河麒麟
内存：64GB
系统盘：240GB
数据盘：128TB，支持存储扩展

声明
1. 本文档所提到的产品规格及资讯仅供参考，相关内容可能随时更新，天融信不另行通知。
2. 本文档中提到的产品功能或性能可能因具体型号、配备环境、配置方法不同而有所差异，此种情况产生的差异为正常现象。
3. 本文档中提到的信息为正常公开的信息，若因本文档或其所提到的任何信息造成或可能造成他人直接或间接的资料流失、利益损失，天融信及其员工不承担任何责任。