普通高等教育“十一五”国家级规划教材  
计算机网络安全技术  
潘瑜 主编  
北京  

内容简介  
本书共10章，主要内容包括计算机网络安全概述、计算机网络安全协议基础、计算机网络安全编程基础、计算机网络操作系统安全基础、计算机网络攻击与入侵技术、计算机网络病毒及反病毒技术、计算机网络站点的安全、数据加密技术基础、防火墙与入侵检测技术、网络信息安全方案设计等。  
本书注重应用，强调基础知识的掌握，同时给出各种网络安全技术及其使用方法。每章附有典型例题、习题和实验。  
本书适合作为应用型本科院校计算机专业、通信专业、信息专业的本科生教材，也可供从事计算机网络安全及相关工作的工程技术人员学习参考。  

前言  
目前，各应用型本科高等院校的“计算机网络安全技术”课程教学已经基本展开。在互联网飞速发展的信息时代，计算机网络安全技术显得愈发重要。本书重点介绍计算机网络安全基础、计算机网络安全协议基础、计算机网络安全编程基础、计算机网络操作系统安全基础、计算机网络攻击与入侵技术、计算机网络病毒及反病毒技术、计算机网络站点的安全、数据加密技术基础、防火墙与入侵检测技术、网络信息安全方案设计等内容。本书的基本内容围绕提高读者的计算机网络安全能力展开。  
在选择本书内容时，我们充分考虑了计算机网络安全技术的实际情况，将相对繁杂的部分舍去，保留了最常用、最基本的部分。本书实例、实验和习题丰富，力求使读者通过学习能够达到“举一反三、融会贯通”的目的。  
本书由江苏技术师范学院潘瑜主编，臧海娟、何胜任副主编，蒋益峰参编。其中第1、2、4、7章由潘瑜编写，第9章的部分节由臧海娟编写，第3、5、8章由何胜编写，第6章及第9章的部分节由蒋益锋编写，最终由潘瑜统稿成书。  
本书在编写过程中得到了江苏技术师范学院史国栋、施步洲和周丽琴的大力支持，韩君为本书做了大量文字录入和排版工作，在此表示衷心的感谢！  
本书的出版还得到江苏省六大人才高峰项目和江苏技术师范学院自然科学研究项目的资助，在此表示衷心的感谢！  
由于编者水平有限，书中难免有疏漏和错误，欢迎广大读者批评指正。  
编者  
2007年3月  

目录  
前言  
第1章 计算机网络安全概述  
1.1 网络安全概述  
1.1.1 网络安全现状  
1.1.2 网络安全面临的威胁  
1.1.3 网络安全面临的困难  
1.1.4 网络安全组织与机构  
1.2 网络安全体系结构  
1.2.1 网络安全总体框架  
1.2.2 安全服务  
1.2.3 安全机制  
1.2.4 安全管理  
1.3 网络安全法规和网络安全评价标准  
1.3.1 网络安全的相关法规  
1.3.2 我国评价标准  
1.3.3 国际评价标准  
第2章 计算机网络安全协议基础  
2.1 协议族  
2.1.1 协议族模型  
2.1.2 协议族参考模型各层的功能  
2.2 协议  
2.2.1 数据报格式  
2.2.2 地址  
2.3 协议  
2.3.1 协议简介  
2.3.2 端口的概念  
2.3.3 报文段格式  
2.3.4 连接  
2.4 协议  
2.4.1 协议及特点  
2.4.2 报文格式  
2.5 协议  
2.5.1 协议简介  
2.5.2 报文格式  
2.5.3 报文的形成  
2.6 常见网络服务  
2.6.1 服务  
2.6.2 服务  
2.6.3 邮件服务  
2.6.4 服务  
2.7 常用网络命令  
2.7.1 命令  
2.7.2 命令  
2.7.3 命令  
2.7.4 命令  
2.8 本章实验  
2.8.1 实验一 网络抓包工具的安装与使用  
2.8.2 实验二 虚拟机软件的安装和配置  
本章小结  
思考与练习  
第3章 计算机网络安全编程基础  
3.1 计算机网络编程概述  
3.2 网络编程基础  
3.3 计算机网络安全编程实例  
3.3.1 程序实现  
3.3.2 修改注册表程序实现  
3.3.3 驻留内存程序实现  
3.3.4 多线程程序实现  
3.4 本章实验  
实验一 编程检测“冰河”木马  
本章小结  
思考与练习  
第4章 计算机网络操作系统安全基础  
4.1 网络操作系统安全概述  
4.1.1 网络操作系统安全概念  
4.1.2 网络操作系统的安全配置  
4.2 Windows Server 2000系统的安全  
4.2.1 Windows Server 2000操作系统安全简介  
4.2.2 Windows Server 2000安全配置  
4.3 Unix/Linux系统的安全  
4.3.1 系统的基本安全  
4.3.2 系统的安全  
4.4 本章实验  
4.4.1 实验一 为Windows Server 2000系统安装补丁  
4.4.2 实验二 设置Windows Server 2000的系统管理员账号密码和管理员账号改名  
4.4.3 实验三 设置Windows Server 2000系统的审计功能和关闭不必要的服务  
本章小结  
思考与练习  
第5章 计算机网络攻击与入侵技术  
5.1 端口扫描  
5.1.1 关于漏洞  
5.1.2 端口扫描简介  
5.1.3 端口扫描的原理  
5.1.4 端口扫描的工具  
5.2 网络监听  
5.2.1 网络监听的原理  
5.2.2 网络监听的检测  
5.2.3 常用的网络监听工具  
5.2.4 网络监听的防御  
5.3 欺骗  
5.3.1 欺骗的原理  
5.3.2 欺骗技术的特征以及攻击步骤  
5.3.3 欺骗的实施工具  
5.3.4 防止和检测欺骗的方法  
5.4 拒绝服务攻击  
5.4.1 拒绝服务攻击原理及防范  
5.4.2 分布式拒绝服务攻击及其防范  
5.4.3 拒绝服务攻击的发展趋势  
5.5 特洛伊木马  
5.5.1 特洛伊木马程序简介  
5.5.2 特洛伊木马程序隐藏的位置  
5.5.3 特洛伊木马的发展  
5.5.4 特洛伊木马的检测  
5.5.5 清除木马的基本方法  
5.5.6 防范木马入侵的方法  
5.6 邮件炸弹  
5.6.1 邮件炸弹的原理  
5.6.2 邮件炸弹的防范  
5.7 缓冲区溢出  
5.7.1 缓冲区溢出简介  
5.7.2 缓冲区溢出原理  
5.7.3 避免缓冲区溢出的基本方法  
5.8 本章实验  
实验一 用流光攻击服务器获取密码并修改网页  
本章小结  
思考与练习  
第6章 计算机网络病毒及反病毒技术  
6.1 计算机病毒概述  
6.1.1 计算机病毒的概念  
6.1.2 计算机病毒的发展史  
6.1.3 计算机病毒的特征  
6.1.4 计算机病毒的三个组成部分  
6.1.5 计算机病毒的生命周期  
6.1.6 计算机病毒的种类及工作原理  
6.2 计算机病毒的检测和清除  
6.2.1 计算机病毒的检测  
6.2.2 计算机病毒的消除  
6.2.3 常用计算机杀毒软件及其工作原理  
6.3 本章实验  
实验一 新欢乐时光病毒实验  
实验二 冲击波病毒实验  
本章小结  
思考与练习  
第7章 计算机网络站点的安全  
7.1 因特网面临的安全问题  
7.1.1 因特网服务面临的安全问题  
7.1.2 因特网本身面临的安全问题  
7.2 站点的安全策略和安全管理  
7.2.1 制定站点安全策略的原则  
7.2.2 配置安全的服务器  
7.2.3 及时消除服务器站点中的安全漏洞  
7.2.4 严密监控进出服务器站点的数据流  
7.3 网络站点口令安全  
7.3.1 口令破解过程  
7.3.2 设置安全的口令  
7.4 本章实验  
实验一 基于Windows Server环境的服务器的安全配置  
实验二 基于Unix/Linux环境的服务器的安全配置  
本章小结  
思考与练习  
第8章 数据加密技术基础  
8.1 数据加密技术概述  
8.1.1 保密通信模型  
8.1.2 经典加密方法  
8.1.3 现代密码体制  
8.2 对称密码体制  
8.2.1 美国数据加密标准  
8.2.2 算法  
8.3 非对称密码体制  
8.3.1 非对称密码体制简介  
8.3.2 算法设计思想  
8.4 散列函数与数字签名  
8.4.1 散列函数  
8.4.2 消息摘要  
8.4.3 安全散列函数  
8.4.4 数字签名  
8.5 本章实验  
实验一 加密程序实现  
本章小结  
思考与练习  
第9章 防火墙与入侵检测技术  
9.1 防火墙及体系结构  
9.1.1 防火墙的概念  
9.1.2 防火墙体系结构  
9.2 防火墙的分类及主要技术  
9.2.1 防火墙的类型  
9.2.2 包过滤技术  
9.2.3 代理技术  
9.2.4 网络地址转换技术  
9.3 防火墙的指标与选择  
9.3.1 防火墙的选择  
9.3.2 几种典型防火墙产品  
9.3.3 硬件防火墙实例  
9.4 入侵检测系统  
9.4.1 入侵检测系统概述  
9.4.2 入侵检测系统的分类  
9.4.3 两种基本的入侵检测技术  
9.4.4 入侵检测系统模型  
9.4.5 入侵检测系统的常见组件及部署  
9.4.6 入侵检测系统的产品及选型  
9.5 网络入侵检测系统  
9.5.1 简介  
9.5.2 安装  
9.5.3 工作模式  
9.5.4 的使用  
9.5.5 编写规则  
9.6 本章实验  
9.6.1 实验一 防火墙的初始配置  
9.6.2 实验二 配置防火墙的网桥模式功能，验证网桥模式下配置的有效性  
9.6.3 实验三 配置防火墙的静态NAT、PAT功能，验证功能配置  
9.6.4 实验四 防火墙规则配置  
本章小结  
思考与练习  
第10章 网络信息安全方案设计  
10.1 网络信息安全方案概述  
10.1.1 什么是网络信息安全解决方案  
10.1.2 网络安全的一般需求  
10.1.3 网络信息安全方案设计原则  
10.1.4 网络安全层次及安全措施  
10.1.5 安全管理  
10.2 网络信息安全方案设计  
10.2.1 网络信息安全系统设计步骤  
10.2.2 企业信息安全解决方案  
10.3 本章实验  
10.3.1 实验一 基于Windows的实验网络安全解决方案  
10.3.2 实验二 网络连接及地址静态配置  
10.3.3 实验三 静态路由配置  
10.3.4 实验四 服务器配置  
10.3.5 实验五 服务器/客户机设置  
本章小结  
思考与练习  
参考文献  

第1章 计算机网络安全概述  
学习目标  
计算机网络中的安全问题与现实社会中的安全问题一样，都是一个永恒而且难以解决的问题。本章从介绍网络安全现状、网络安全面临的威胁和困难入手，引出对网络安全体系结构的描述，并讨论网络安全法规和评价标准，以帮助读者全面理解网络安全的概念。

1.1 网络安全概述  
1.1.1 网络安全现状  
随着计算机网络的普及和应用的发展，人类对计算机网络的依赖程度加深。计算机网络安全不仅对每个人都有现实意义，亦对国家的政治、经济和国防安全至关重要。网络安全问题曾为某些生产企业、金融公司甚至政府部门带来重大损失。  
实际上，计算机网络安全问题是现实社会中各种安全问题在虚拟社会中的映射。现实生活中可能存在的各类问题在计算机网络中同样存在。例如，真实社会中的商业活动可能遇到商业欺诈，农民可能会买到假种子、假化肥；企业和个人可能会遇到假钞等。在计算机网络技术的电子商务活动中，亦可能遭遇各种类型的攻击，如计算机病毒、商业信息窃取、拒绝服务、虚假身份等。不同之处在于，由于计算机网络的开放性、匿名性和技术复杂性，攻击和破坏在网络中比在现实社会中要容易得多。例如，在网络中隐藏身份或冒名顶替的难度远低于现实社会。  
在计算机网络安全领域，“黑客”一词频繁出现，本意是指一些高水平的程序员，他们可以发现系统中的潜在漏洞，互相交换安全信息和技术，但从未蓄意破坏他人系统。而那些未经授权进入他人系统、具有恶意并非法获取信息、破坏系统或修改、删除数据的人被称为“破坏者”。这些攻击和破坏行为可能对系统造成重大损失。  
随着互联网日益普及，各种网络攻击工具极易从网站上获取，计算机网络安全形势与互联网初期有了很大变化。现在，即使是初学者也能利用各种工具轻松攻击计算机系统。尽管采取安全防护措施的机器增多，但随着计算机的普及，越来越多的家庭用户和非专业用户在使用计算机，使得因特网上不设防、存在安全漏洞的计算机也越来越多。  
如今，“黑客”已经失去早期“技术高手”的含义，成为所有攻击活动者的代名词。在本书中，进行未经授权的访问、修改数据或使系统不可靠、不适用的活动称为“攻击活动”，从事此类活动的人统一称为“黑客”。  
进行计算机网络攻击的“黑客”有以下几种类型：  
（1） 第一种人  
这类人仅为提高知名度，拥有丰富资源（时间、计算资源和金钱等），不断寻找目标，进行各种尝试性攻击。  
（2） 第二种人  
这类人没有明确目的，可能入侵不同系统，修改服务器主页，发送大量垃圾信息。  
（3） 第三种人  
计算机网络安全技术研究人员为了证明某计算机系统不安全，进行模拟攻击，以找出系统安全隐患。  
（4） 第四种人  
这类人有计划、有目的地对特定系统进行破坏和攻击。

1.1.2 网络安全面临的威胁  
网络的互联拓展了计算机应用的空间，但互联技术及计算机系统的弱点，也使得所有网络用户因为彼此互联而更易受到攻击。通过网络，我们与现实社会中的各类人建立了联系。  
假设主机A和主机B是计算机网络中的两个用户，主机C是连接在网络上的第三个用户，A和B之间正在进行正常通信。在这种情况下，主要安全问题包括：  
1） 主机C对主机A或B的非授权访问。  
2） 主机C冒用主机A或B的身份对网络上其他主机进行访问。  
3） 主机C使主机A或B无法使用网络。  

归纳起来，计算机网络安全面临的风险主要有以下几种：  
1. 保密性  
在计算机网络中，通信双方的信息可能被第三方获取。  
2. 认证  
通信双方在通信前需要确认彼此身份，确保不是假冒对象。  
3. 完整性  
信息在传输过程中不可被篡改，或即使被篡改也能被发现。  
4. 不可否认性  
在电子交易中，发出信息的一方无法否认其行为。  
5. 可用性  
计算机网络的基础设施、硬件和软件系统需在任何时候可靠运行，供所有用户正常使用。  

要解决这些网络安全问题，需要综合运用多种技术手段、管理手段和法律手段。其中，保密性、认证、完整性、不可否认性等问题主要基于密码算法及其应用，而可用性则涉及更多的因素，如访问控制、管理等。因此，我们将在介绍攻击的基础上，介绍加密技术及其应用，以及各种常见安全防护手段，说明如何通过有效的安全管理，综合各种技术手段，从而达到较为安全的防护效果。  

另外，从信息系统面临的威胁来看，最具破坏性的威胁主要来自内部。内部威胁中，危害性最大的往往是内部关键人员为了某种利益从事的攻击、破坏活动。对工作不满、被辞退或与外部勾结的工作人员，更容易获取和破坏内部的关键信息。工作中的疏忽，也经常导致各种漏洞。  
因此，如果发现攻击者声势浩大地对系统进行入侵、破坏，实际上产生的危害可能并不大。很可能是一个业余攻击者，使用从网络获得的攻击工具“练手”。真正的危害来自那些不动声色的“专业”攻击者，他们能够长期窃取、修改信息，并使攻击活动隐蔽不被发现。  

综上所述，网络安全防护可定义为拒绝未经授权的物理或电子入侵、操作，保证网络和所传信息端到端的完整性，抗拒各种类型的破坏，包括电子袭击、物理袭击和人为错误等。  

1.1.3 网络安全面临的困难  
计算机网络中的安全问题与现实社会的安全问题一样，都是一个永恒且难以解决的问题，未来也难以有“一劳永逸”的解决方案，这主要由以下几个方面的原因造成：  
1. 网络攻击与防守的不对称性  
“黑客”在攻击网络时，通常不遵循正常用户的规则，利用操作系统或网络协议的漏洞进行攻击。分析黑客攻击过程可以发现，他们的攻击行动通常经过精心准备，攻击工具也易于获得。因此，黑客攻击的风险低，且难以追踪。网络系统管理员则需堵住所有可能的漏洞，因特网的复杂性和协议与应用的增加使得安全防护难度加大。  
此外，黑客的攻击是主动行为，可在任意时间进行，而系统管理员无法做到全天候防守。因此，网络攻击与防守极为不对称，100%网络安全是非常难以实现的。  
2. 网络安全的动态性  
计算机网络技术发展迅速，随着技术的进步，网络操作系统、硬件平台、应用软件和协议都在不断变化。用户安装新服务器、升级操作系统、采用新协议后，原有的安全问题可能消失，但新的安全问题和漏洞又会出现。因此，网络安全是动态的，无法存在“一劳永逸”的解决方案。攻击者总是占有优势，防守者必须仔细检查每个可能的漏洞，一旦疏忽，系统就可能被攻破。  
3. 网络安全的成本问题  
计算机网络安全成本包括资金、人力资源和时间成本。为了提高网络安全，管理者可能需要安装更多安全设备、雇用更多专业人员，资源越多，安全程度越高。但如果安全成本过高，甚至超过保护信息资源的价值，则投入就失去实际意义。同样，若黑客攻击的代价超过了获益，攻击也没有意义。  
计算机网络服务本质上是开放的，搜索引擎、新闻网站、门户网站和公共信息网站面向所有用户，因此采取各种网络防范措施意味着限制开放性，必然给用户带来不便。因此，网络安全措施并不一定越多越好，既要兼顾安全，又要兼顾易用性。极其繁琐的安全措施无人愿用。  
4. 网络安全的本质  
多年来，网络安全更多地被视为技术问题，关注焦点在技术，例如数据加密、安全访问控制、安全监控等。但仔细研究网络安全面临的问题，可以发现一个有趣现象：无论采用何种网络安全防护技术，最终的安全都要落实在人身上。决定战争胜负的是人而非物。网络安全问题的本质在于人性的弱点，用户往往认为自己不会成为黑客攻击的目标，或认为系统已安装了先进的网络安全设备且有管理员在管理，故不存在网络安全问题。  
因此，要确保网络安全，必须加强和普及网络安全知识的教育，改善网络安全技术的管理手段，最大限度地减少风险，增加攻击者成本。不论网络安全技术多么完善，都必须有人参与和管理，才能较好地发挥作用。因此，建立安全意识，强化安全管理更为重要。  

1.1.4 网络安全组织与机构  
计算机网络安全问题是全球性问题，许多组织和机构正在开展网络安全研究，作为计算机网络安全专业人员，了解这些组织和机构是必要的。  
1. IETF  
因特网工程任务组（IETF）是一个大型开放国际组织，由网络设计、运行、研究和厂商等人员组成，致力于推动因特网发展。因特网的标准通过IETF制定，相关标准文件按顺序编号，越新编号越高。每位成员都可提出建议，发布在网络上供讨论，最终形成草案和标准。  
2. CERT  
计算机安全应急响应/协同中心（CERT CC）由美国政府资助，位于卡耐基梅隆大学软件工程研究所，提供网络安全技术支持和信息。其工作包括协同对网络安全事件的响应、提出针对不同网络安全问题的解决方案、研究网络入侵活动的趋势等。成立于1988年，现已成为因特网上最著名的安全组织之一。  
3. NSA与NIST  
美国国家安全局（NSA）是美国政府的情报机构，进行信息收集、加密、解密、分析等工作，提供网络安全产品和服务。美国国家标准局（NIST）负责制定各领域产品的技术标准。其计算机安全资源中心主要从事安全风险研究和标准开发。  
4. ISO与ITU  
国际标准化组织（ISO）制定了一系列网络安全标准，国际电信联盟（ITU）在信息处理方面也制定了一些标准。  
5. 其他组织  
除了政府机构和著名组织外，还有许多民间组织和机构在网络安全领域开展研究，提供有关网络安全的信息。  

1.2 网络安全体系结构  
计算机网络安全是一个涉及广泛的研究领域。通常，人们只在某一小范围内从事研究，开发出解决特殊网络安全问题的方案。为了整体研究计算机网络安全问题，必须研究网络安全体系结构，从系统整体角度理解网络安全问题的解决方案，对网络安全研究和管理具有指导作用。  

1.2.1 网络安全总体框架  
尽管研究者的研究领域只涉及网络安全的某小范围，但他们应清楚自己的研究问题在整个网络安全领域中的地位及与其他安全问题的关系。因此，应理解计算机网络安全的总体框架。  

1.2.2 安全服务  
网络安全体系结构定义了一组安全服务，包括：  
1. 认证服务  
提供某个实体的身份保证。  
2. 访问控制服务  
提供对网络中某些受限制资源的访问方法。  
3. 数据保密性服务  
保护系统信息不被泄漏。  
4. 数据完整性服务  
保护数据在存储和传输过程中的完整性。  
5. 抗否认服务  
保护网络通信系统不遭受来自合法用户的威胁。  

1.2.3 安全机制  
为实现网络安全服务，需在安全体系结构中定义安全机制，包括：  
1. 加密机制  
利用加密算法对数据进行加密。  
2. 数字签名机制  
通过数字签名确保数据的真实性。  
3. 访问控制机制  
支持访问控制服务。  
4. 数据完整性机制  
支持数据完整性服务。  
5. 鉴别交换机制  
确认实体身份的交换机制。  
6. 业务流填充机制  
防止第三者通过数据流量推测数据内容。  
7. 路由控制机制  
选择安全路由以保证数据安全。  
8. 公证机制  
建立有权威的第三方认证机构。  

1.2.4 安全管理  
安全管理是安全体系结构的第三部分，通过实施一系列安全策略，对计算机网络的操作进行管理。安全管理既支持网络整体的强制安全管理策略，又支持网络中对安全有更高要求的个别系统的自主安全策略。安全管理由系统安全管理、安全服务管理和安全机制管理组成。  

1.3 网络安全法规和网络安全评价标准  
1.3.1 网络安全的相关法规  
经过近20年的发展，许多国家已经建立了完备的网络安全法规。  
1. 我国立法情况  
我国在计算机网络安全方面的法律众多，基本精神适用于数字空间的国家大法有《中华人民共和国宪法》、《中华人民共和国商标法》、《中华人民共和国专利法》、《中华人民共和国保守国家秘密法》和《中华人民共和国反不正当竞争法》。  
为了加强对计算机犯罪的打击力度，1997年在重新修订《中华人民共和国刑法》时，加入了多条关于计算机犯罪的条款。  
2. 国际立法情况  
主要国家都有相关的计算机网络安全领域的立法，包括美国的个人隐私法、反腐败法、伪造访问设备法、电子通信隐私法等，欧洲共同体、英国、俄罗斯和新加坡等国亦有相关立法。  

1.3.2 我国评价标准  
我国的计算机信息系统安全保护等级划分准则将计算机安全保护分为五个级别，分别为用户自主保护级、系统审计保护级、安全标记保护级、结构化保护级和访问验证保护级。  

1.3.3 国际评价标准  
国际上网络安全评价标准一般遵循1985年美国国防部开发的“可信任计算机标准评价准则”，即“网络安全橙皮书”。该标准将计算机系统的安全性分为四个级别，分别为D级、C级、B级和A级。